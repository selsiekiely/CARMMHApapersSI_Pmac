---
title: "Sperm whale population recovery from commercial whaling in the Gulf of Mexico"
author: "Len Thomas"
date: "12/Jan/2020, updated 25/May/2020"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

The aim of this analysis is to determine whether sperm whales in the Gulf of Mexico (GoM) could have recovered from historical commercial whaling by the time of the Deepwater Horizon oil spill in 2010.  

Information about whaling comes from Reeves et al. (2011).  Reeves et al. found evidence for 214 vessel-seasons of whaling between 1788 and 1877; from the records they estimate that 1070 (SE 202) sperm whales were harvested in total in the GoM during that 89 year period, although they also suggest this is an underestimate.

We will use the sperm whale stage-structured population model described in Schwacke et al. (2015, Section 3.4), which in turn is similar to the model of Chiquet et al. (2013).  Important differences are that the Schwacke et al. model follows both females and males (rather than just females) and that it includes density dependence (assumed to operate on fecundity).  Relevant demographic parameters are given below.

We will assume that sperm whales were at carrying capacity before whaling began, and we will assume that this carrying capacity is the same as that used by Schwacke et al. - i.e., 1616 animals.  (Note, I think this is an estimate only of the US stock, so is likely an underestimate of the total population; however whaling also largely took place in the Northern Gulf, except for some in the Bay of Campeche - see Reeves et al.)

We will use code written by Tiago Marques, which is based on code by Lance Garrison used in Schwacke et al. (2015).  Not all of the code is given here -- some is sourced in to this document -- but it is all available on demand.

```{r}
#Load library to do matrix population modelling
library(popbio)
#Load code files from Tiago
source("buildPPM.R")
source("GetStablePop.R")
source("getSpData.R")
#Load code file from Tiago adapted by Len to add harvest
source("RunSpWithHarvest.R")

#Load the sperm whale population parameters from a spreadsheet
Pmac <- getSpData("Pmac", file ="SpeciesDefinitionFile.xlsx") 

#Set the inter-birth interval required to give a stable population
#This is the value that Tiago found worked, which is slightly different from that of Lance's
Pmac$ibnom <- 6.236487

#Number of years to run model forward
# 1788 was the first year of documented harvest in the Reeves paper
# Their effort plot is decadal, starting in 1785, so I'll start from then, and assume whaling started that year
# DWH oil spill was in 2010, so run through to 2010.
# Total run, therefore is from 1785 to 2010 - 226 years
n.years <- 226 
```



## No harvest scenario

Do a baseline run, with no harvest, just to check the code.  This should produce no population change.

```{r}
#baseline - no harvest, just to check things are working!
NoHarvestScenario <- runSpWithHarvest(Pmac, n.years)
plot(1:n.years + 1784,rowSums(NoHarvestScenario),ylim=c(0,2000),ylab="Population size",xlab="Year", type = "l")
```

## Scenario 1 - equal takes in all stages

This scenario (unrealistically) assumes equal take in each of the 8 stages (female calf, female juvenile, female adult, female adult with calf, female adult post-breeding, male calf, male juvenile, male adult).

In pro-rating the total harvest over time, we use Figure 3 from Reeves et al, which gives whaling effort by decade from 1785.  Values have been read by eye from that figure.  We assume that effort was evenly distributed over each decade, and that takes were proportional to effort.  (This last assumption might be unrealistic if resources are being depleted, for example, although Reeves et al. mention that whaling did not stop in the GoM because the stock was exhausted.)

```{r}
#harvest scenario 1
#Assume all stages targetted equally, including calves
stages.to.harvest <- c(1:5, 11:13)
#Whaling effort by decade, from figure 3 of Reeves paper - should sum to 214
effort <- c(18,20,2,2,20,25,77,20,20,10)
#Assume equally spread over the decade
effort.years <- rep(effort/10, each = 10)
#Add in the other years
effort.years <- c(effort.years, numeric(n.years - length(effort.years)))
#Total of 1070 whales estimated to have been taken (SE 202) (Reeves notes it's likely an underestimate)
total.taken <- 1070
whales.taken.per.year.and.stage <- total.taken / (sum(effort.years) * length(stages.to.harvest))
harvest.matrix1 <- matrix(0, n.years, 16)
harvest.matrix1[, stages.to.harvest] <- whales.taken.per.year.and.stage * effort.years
HarvestScenario1 <- runSpWithHarvest(Pmac, n.years, harvest = harvest.matrix1)
plot(1:n.years + 1776,rowSums(HarvestScenario1),ylim = c(0, 2000), ylab="Population size",xlab="Year", type = "l", main = "Equal harvest across stages scenario.")
```

Under this scenario, the population has recovered so that by 2010 estimated population size is `r round(sum(HarvestScenario1[n.years, ]))`, `r round(sum(HarvestScenario1[n.years, ])/Pmac$totn * 100)`\% of the way to the carrying capacity of `r Pmac$totn`.

## Scenario 2 - all take on adult females

Adult females are the most important component of the population, demographically speaking.  This scenario assumes that all of the take is on them.  For ease of implementation, we have assumed that this is on stage 3, which is adult females before breeding (i.e., does not include adult females with calves or adult females between breeding).

```{r}
#harvest scenario 2 - all adult females (stage 3 - i.e.., not with calves or post-calf)
whales.taken.per.year <- total.taken / (sum(effort.years))
harvest.matrix2 <- matrix(0, n.years, 16)
harvest.matrix2[, 3] <- whales.taken.per.year * effort.years
HarvestScenario2 <- runSpWithHarvest(Pmac, n.years, harvest = harvest.matrix2)
plot(1:n.years + 1776,rowSums(HarvestScenario2),ylim = c(0, 2000), ylab="Population size",xlab="Year", type = "l", main = "All take on adult females.")
```

Under this scenario, the population has not recovered: in 2010 estimated population size is `r round(sum(HarvestScenario2[n.years, ]))`, which is only `r round(sum(HarvestScenario2[n.years, ])/Pmac$totn * 100)`\% of the way to the carrying capacity of `r Pmac$totn`.

## Scenario 3 - take in proportion to stable age distribution

This scenario is a little more realistic - it assumes that the proportion of each stage taken is proportional to their stable age proportion at carrying capacity.  These proportions are as follows (the order is the same as that given above when first describing the stages.) 

```{r}
stage.structure <- HarvestScenario1[1, ]/sum(HarvestScenario1[1, ])
print(round(stage.structure[c(1:5, 11:13)], 3))
```

```{r}
harvest.matrix3 <- matrix(0, n.years, 16)
for(i in 1:n.years) {
  harvest.matrix3[i, ] <- effort.years[i] * stage.structure * whales.taken.per.year
}
HarvestScenario3 <- runSpWithHarvest(Pmac, n.years, harvest = harvest.matrix3)
plot(1:n.years + 1776,rowSums(HarvestScenario3),ylim = c(0, 2000), ylab="Population size",xlab="Year", type = "l", main = "Take in proportion to stable age distribution.")
```

Under this scenario, the population has recovered, with the 2010 estimated population size of `r round(sum(HarvestScenario3[n.years, ]))` being `r round(sum(HarvestScenario3[n.years, ])/Pmac$totn * 100)`\% of the way to carrying capacity.

## Discussion

Under the most realistic scenario used here, the sperm whale population is estiamted to have recovered to carrying capacity over the 130 years or so since the end of commercial whaling in the Gulf.  However, there are many caveats.

* The assumed population model may be wrong; results are likely very sensitive to assumptions about density dependent response.

* Results are sensitive to the abundance estimate used as an estimate of carrying capacity.  The estimate used here was 1616, which comes from the injury quantification Schwacke (2015) (although we note that the value actually given in Schwacke is 1635).  This is much higher than the NOAA stock assessment document (https://www.nefsc.noaa.gov/publications/tm/tm238/255_f2015_spermGmex.pdf), which uses a summer 2009 survey to set the carrying capacity at 763 (with CV of 0.38).  The number used here appears to be from the 2003-4 summer surveys (see Table 1 of the NOAA report), where a value of 1665 is given (with CV 0.2).  Note that these values are just for the Northern Gulf - i.e., US waters, which comprize 40\% of the total waters in the Gulf.  They are also not corrected for the proportion of animals missed on the trackline ("g(0)").  Roberts et al. (2016, https://www.nature.com/articles/srep22615) used model-based analysis of line transect data to derive an estimate of 2128 (CV 0.08) for Sperm whales in the Northern Gulf.

* The distribution of whaling effort was not even through the Gulf, and the distribution of whale stages may also not be even (there may be more female groups in the North and males in the South).

* Results are likely sensitive to assumption that historical (year 1755) and current carrying capacity are the same. For example, carrying capacity may now perhaps be lower, due to anthropogenic impact.

* The assumption that animals were taken in proportion to their stage frequency at carrying capacity may not be correct.  There may have been selectivity on the part of the whalers.  Stage structure may have changed as whaling proceeded (and density dependent mechanisms came into action).  One relevant thing here is Reeves et al. Figure 7, which shows the distribution of the number of barrels of oil taken per whale.  This makes it clear that relatively few large males were taken, and relatively few very small animals -- this is consistent with the stage frequencies given above.

We have shown that it is possible that the sperm whale population was depleted in such a way that it has not recovered, if adult females were targeted.  Our overall conclusion, therefore, is that while there is considerable uncertainty, it seems most likely that the population had recovered from whaling by the time of the Deepwater Horizon oil spill.

## References

Chiquet et al. 2013. Demographic analysis of sperm whales using matrix population models.  Ecological modelling 248: 71-79.

Reeves et al. 2011. Insights From Whaling Logbooks on Whales, Dolphins, and Whaling in the Gulf of Mexico, Gulf of Mexico Science 2011: 41–67

Schwacke et al. 2015,  Models and analyses for the quantification of injury to Gulf of Mexico cetaceans from the Deepwater Horizon Oil Spill. DWH NRDA Marine Mammal Technical Working Group Report. 
[https://www.fws.gov/doiddata/dwh-ar-documents/876/DWH-AR0105866.pdf] (https://www.fws.gov/doiddata/dwh-ar-documents/876/DWH-AR0105866.pdf)